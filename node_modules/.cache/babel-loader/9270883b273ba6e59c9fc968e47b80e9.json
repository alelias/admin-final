{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useRef, useState, useEffect, useCallback } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder';\n\nconst axios = require(\"axios\");\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoid2FsZXRhIiwiYSI6ImNreGV6ZHdpbzF5Y2sycXBmb2Q4cXAwOTIifQ.n2IlnUqJNEEfDHk6qPNsoQ';\nconst baseUrl = \"https://back-calistenia.herokuapp.com/api/parque\";\nexport const useMapbox = puntoInicial => {\n  _s();\n\n  const mapaDiv = useRef();\n  const setRef = useCallback(node => {\n    mapaDiv.current = node;\n  }, []); //referencia a los marcadores\n\n  const marcadores = useRef({});\n  const [data, setData] = useState([]);\n  const mapa = useRef();\n  const [coords, setCoords] = useState(puntoInicial);\n  useEffect(() => {\n    const peticionGet = async () => {\n      await axios.get(baseUrl).then(response => {\n        setData(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    peticionGet();\n  }, []); //funcion agregar marcadores\n\n  /*\n  const agregarMarcador = useCallback((ev) => {\n      const {lng, lat} = ev.lngLat;\n          const marker = new mapboxgl.Marker();\n          \n           marker\n          .setLngLat([lng, lat])\n          .addTo(mapa.current)\n          .setDraggable(true)\n        \n           //escuchar movimientos del marcador\n          marker.on('dragend', ({target}) => {\n              const {id} = target;\n              const {lng, lat} = target.getLngLat();\n              //emitir cambios\n              console.log(lng, lat)\n              \n          })\n  },[])\n  */\n\n  useEffect(() => {\n    var map = new mapboxgl.Map({\n      container: mapaDiv.current,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [puntoInicial.lng, puntoInicial.lat],\n      zoom: puntoInicial.zoom\n    });\n    map.addControl(new mapboxgl.NavigationControl());\n    map.addControl(new MapboxGeocoder({\n      accessToken: mapboxgl.accessToken,\n      mapboxgl: mapboxgl\n    }));\n    data.forEach(park => {\n      const marker = new mapboxgl.Marker().setLngLat([park.longitud, park.latitud]).addTo(map);\n    });\n    mapa.current = map;\n  }, []); //cuando se mueve el mapa\n\n  useEffect(() => {\n    var _mapa$current;\n\n    (_mapa$current = mapa.current) === null || _mapa$current === void 0 ? void 0 : _mapa$current.on('move', () => {\n      const {\n        lng,\n        lat\n      } = mapa.current.getCenter();\n      setCoords({\n        lng: lng.toFixed(6),\n        lat: lat.toFixed(6),\n        zoom: mapa.current.getZoom().toFixed(2)\n      });\n    });\n  }, []); //agregar marcadores\n\n  /*\n  useEffect(() => {\n      mapa.current?.on('click', agregarMarcador);\n     \n  }, [agregarMarcador])\n  */\n\n  return {\n    coords,\n    setRef,\n    marcadores\n  };\n};\n\n_s(useMapbox, \"QFomOXPSMZLvctnd69mr9r+6yQM=\");","map":{"version":3,"sources":["/Users/alexelias/Desktop/proyectos-react/calisteniaApp/frontendadmin/src/hooks/useMapbox.js"],"names":["useRef","useState","useEffect","useCallback","mapboxgl","MapboxGeocoder","axios","require","accessToken","baseUrl","useMapbox","puntoInicial","mapaDiv","setRef","node","current","marcadores","data","setData","mapa","coords","setCoords","peticionGet","get","then","response","catch","error","console","log","map","Map","container","style","center","lng","lat","zoom","addControl","NavigationControl","forEach","park","marker","Marker","setLngLat","longitud","latitud","addTo","on","getCenter","toFixed","getZoom"],"mappings":"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","sourcesContent":["import {useRef,useState, useEffect, useCallback}  from 'react'\nimport mapboxgl from 'mapbox-gl'\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder'\nconst axios = require(\"axios\");\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoid2FsZXRhIiwiYSI6ImNreGV6ZHdpbzF5Y2sycXBmb2Q4cXAwOTIifQ.n2IlnUqJNEEfDHk6qPNsoQ';\nconst baseUrl = \"https://back-calistenia.herokuapp.com/api/parque\";\n\n\nexport const useMapbox = (puntoInicial) => {\n    \n    const mapaDiv = useRef()\n    const setRef = useCallback((node) => {\n            mapaDiv.current = node;\n    },[])\n\n    //referencia a los marcadores\n    const marcadores = useRef({});\n\n    const [data, setData] = useState([]);\n  \n\n    const mapa = useRef()\n    const [coords, setCoords] = useState(puntoInicial)\n\n  \n\n      useEffect(() => {\n        const peticionGet = async () => {\n    \n            await axios.get(baseUrl)\n              .then((response) => {\n              \n                setData(response.data);\n              })\n              .catch((error) => {\n                console.log(error);\n              });\n          };\n        peticionGet();\n      }, []);\n      \n\n    //funcion agregar marcadores\n    /*\n    const agregarMarcador = useCallback((ev) => {\n        const {lng, lat} = ev.lngLat;\n            const marker = new mapboxgl.Marker();\n            \n\n            marker\n            .setLngLat([lng, lat])\n            .addTo(mapa.current)\n            .setDraggable(true)\n\n         \n\n            //escuchar movimientos del marcador\n            marker.on('dragend', ({target}) => {\n                const {id} = target;\n                const {lng, lat} = target.getLngLat();\n                //emitir cambios\n                console.log(lng, lat)\n                \n            })\n    },[])\n*/\n    useEffect(() => {\n        var map = new mapboxgl.Map({\n            container: mapaDiv.current,\n            style: 'mapbox://styles/mapbox/streets-v11',\n            center: [puntoInicial.lng, puntoInicial.lat],\n            zoom: puntoInicial.zoom\n        });\n        map.addControl(new mapboxgl.NavigationControl());\n        \n        map.addControl(\n            new MapboxGeocoder({\n            accessToken: mapboxgl.accessToken,\n            mapboxgl: mapboxgl\n            })\n        );\n\n        data.forEach((park) => {\n            const marker = new mapboxgl.Marker()\n        .setLngLat([park.longitud,park.latitud])\n        .addTo(map);\n        })\n        \n\n        mapa.current = map;\n    },[])\n\n    //cuando se mueve el mapa\n    useEffect(() => {\n        mapa.current?.on('move', () => {\n            const {lng, lat} = mapa.current.getCenter();\n            setCoords({\n                lng: lng.toFixed(6),\n                lat: lat.toFixed(6),\n                zoom: mapa.current.getZoom().toFixed(2)\n            })\n        })\n    },[])\n\n    //agregar marcadores\n    /*\n    useEffect(() => {\n        mapa.current?.on('click', agregarMarcador);\n       \n    }, [agregarMarcador])\n*/\n    return{\n        coords,\n        setRef,\n        marcadores\n    }\n}\n"]},"metadata":{},"sourceType":"module"}