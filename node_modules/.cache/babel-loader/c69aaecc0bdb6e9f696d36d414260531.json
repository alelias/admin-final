{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useRef, useState, useEffect, useCallback } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder';\n\nconst axios = require(\"axios\");\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoid2FsZXRhIiwiYSI6ImNreGY5ZWtreTFvbnUydXE5aTF5eno4cGUifQ.tIMnTnqPoymEqgtchY33ew';\nconst baseUrl = \"https://back-calistenia.herokuapp.com/api/parque\"; //const imgPunto = '../../img/pngegg.png'\n\nexport const useMapbox = puntoInicial => {\n  _s();\n\n  const mapaDiv = useRef();\n  const setRef = useCallback(node => {\n    mapaDiv.current = node;\n  }, []); //referencia a los marcadores\n\n  const marcadores = useRef({});\n  const [data, setData] = useState([]);\n  useEffect(() => {\n    marcadores.current.focus();\n  }, []);\n  const mapa = useRef();\n  const [coords, setCoords] = useState(puntoInicial);\n  useEffect(() => {\n    const peticionGet = async () => {\n      await axios.get(baseUrl).then(response => {\n        setData(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    peticionGet();\n  }, []);\n  useEffect(() => {\n    const map = new mapboxgl.Map({\n      container: mapaDiv.current,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [puntoInicial.lng, puntoInicial.lat],\n      zoom: puntoInicial.zoom\n    });\n    map.addControl(new mapboxgl.NavigationControl());\n    map.addControl(new MapboxGeocoder({\n      accessToken: mapboxgl.accessToken,\n      mapboxgl: mapboxgl\n    }));\n    data.forEach(park => {\n      const marker = new mapboxgl.Marker().setLngLat([parseFloat(park.longitud), parseFloat(park.latitud)]).addTo(map);\n    });\n    mapa.current = map;\n  }, []); //cuando se mueve el mapa\n\n  useEffect(() => {\n    var _mapa$current;\n\n    (_mapa$current = mapa.current) === null || _mapa$current === void 0 ? void 0 : _mapa$current.on('move', () => {\n      const {\n        lng,\n        lat\n      } = mapa.current.getCenter();\n      setCoords({\n        lng: lng.toFixed(6),\n        lat: lat.toFixed(6),\n        zoom: mapa.current.getZoom().toFixed(2)\n      });\n    });\n  }, []); //agregar marcadores\n\n  /*\n  useEffect(() => {\n      mapa.current?.on('click', agregarMarcador);\n     \n  }, [agregarMarcador])\n  */\n\n  return {\n    coords,\n    setRef,\n    marcadores\n  };\n};\n\n_s(useMapbox, \"7u9wxRQZ8AdHPvYhkRexs0ljXhg=\");","map":{"version":3,"sources":["/Users/alexelias/Desktop/proyectos-react/calisteniaApp/frontendadmin/src/hooks/useMapbox.js"],"names":["useRef","useState","useEffect","useCallback","mapboxgl","MapboxGeocoder","axios","require","accessToken","baseUrl","useMapbox","puntoInicial","mapaDiv","setRef","node","current","marcadores","data","setData","focus","mapa","coords","setCoords","peticionGet","get","then","response","catch","error","console","log","map","Map","container","style","center","lng","lat","zoom","addControl","NavigationControl","forEach","park","marker","Marker","setLngLat","parseFloat","longitud","latitud","addTo","on","getCenter","toFixed","getZoom"],"mappings":"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","sourcesContent":["import {useRef,useState, useEffect, useCallback}  from 'react'\nimport mapboxgl from 'mapbox-gl'\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder'\nconst axios = require(\"axios\");\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoid2FsZXRhIiwiYSI6ImNreGY5ZWtreTFvbnUydXE5aTF5eno4cGUifQ.tIMnTnqPoymEqgtchY33ew';\nconst baseUrl = \"https://back-calistenia.herokuapp.com/api/parque\";\n\n//const imgPunto = '../../img/pngegg.png'\n\nexport const useMapbox = (puntoInicial) => {\n    \n    const mapaDiv = useRef()\n    const setRef = useCallback((node) => {\n            mapaDiv.current = node;\n    },[])\n  \n    //referencia a los marcadores\n    const marcadores = useRef({});\n\n    const [data, setData] = useState([]);\n  \n    useEffect(() => {\n        marcadores.current.focus();\n      },[])\n    const mapa = useRef()\n    const [coords, setCoords] = useState(puntoInicial)\n\n  \n\n      useEffect(() => {\n        const peticionGet = async () => {\n    \n            await axios.get(baseUrl)\n              .then((response) => {\n              \n                setData(response.data);\n              })\n              .catch((error) => {\n                console.log(error);\n              });\n          };\n        peticionGet();\n      }, []);\n      \n\n\n    useEffect(() => {\n        const map = new mapboxgl.Map({\n            container: mapaDiv.current,\n            style: 'mapbox://styles/mapbox/streets-v11',\n            center: [puntoInicial.lng, puntoInicial.lat],\n            zoom: puntoInicial.zoom\n        });\n        map.addControl(new mapboxgl.NavigationControl());\n        \n        map.addControl(\n            new MapboxGeocoder({\n            accessToken: mapboxgl.accessToken,\n            mapboxgl: mapboxgl\n            }) \n        );\n\n        data.forEach((park) => {\n            const marker = new mapboxgl.Marker()\n        .setLngLat([parseFloat(park.longitud),parseFloat(park.latitud)])\n        .addTo(map);\n        })\n        \n\n        mapa.current = map;\n    },[])\n\n    //cuando se mueve el mapa\n    useEffect(() => {\n        mapa.current?.on('move', () => {\n            const {lng, lat} = mapa.current.getCenter();\n            setCoords({\n                lng: lng.toFixed(6),\n                lat: lat.toFixed(6),\n                zoom: mapa.current.getZoom().toFixed(2)\n            })\n        })\n    },[])\n\n    //agregar marcadores\n    /*\n    useEffect(() => {\n        mapa.current?.on('click', agregarMarcador);\n       \n    }, [agregarMarcador])\n*/\n    return{\n        coords,\n        setRef,\n        marcadores,\n    }\n}\n"]},"metadata":{},"sourceType":"module"}